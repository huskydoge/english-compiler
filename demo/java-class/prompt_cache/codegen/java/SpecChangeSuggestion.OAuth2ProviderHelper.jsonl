{"prompt":"Code indentation should be done with tabs (unless minified).\nThe java class can be described with the following details\n\nclass name: OAuth2ProviderHelper\nDocumentation Style: JavaDoc\n\nclass textual description (between the `<<{{~~}}>>` lines) :\n<<{{~~}}>>\n# OAuth2ProviderIntegration Class\n\nOAuth2ProviderIntegration is used to simplify the integration of oauth2 for an existing java api servers, with an existing provider. This class provides an easy way to authenticate users and get their identity, as well as to provide a secure authentication system.\n\nThis helps facilitate the following flow between a client (via a browser), a server (the server program using this class), and a provider (such as github or google).\n\n1. The client sends a request to the server to initiate the OAuth 2.0 flow.\n2, The server responds by redirecting the client to the identity provider's authorization endpoint. This redirect includes a unique authorization code, which the identity provider uses to identify the client and the server.\n3. The client is redirected to the identity provider's login page, where the user is asked to log in and grant the client access to the requested resources.\n4. If the user grants access, the identity redirects the client to the server (redirectURL), which includes the authorization code.\n5. The client sends the authorization code to the server,\n6. The server exchanges the authorization code for an access token\n7. The server uses the access token, to get the client unique identity\n8. The server validate the identity, and logs the user into the server application (outside the scope of this class)\n\n---\n\nThe following is the private string properties which is initialized by the constructor:\n- authorizationURL : oauth2 \"/auth\" endpoint, can include GET parameters\n- scope : Scope parameter to be passed with the authorization URL\n- tokenURL : oauth2 \"/token\" endpoint, can include get parameters\n- redirectURL : redirect URL, to send the user back to, after authorization. This is used by the oauth2 provider, to redirect the user with a valid code after login.\n- clientID : oauth2 client ID, used together with the authorizationURL to redirect the user for login via the browser\n- clientSecret : oauth2 client secret, used to perform server to server communication with the oauth provider, to get the valid access token.\n- identityURL : JSON API endpoint from the provider, to get the unique login ID (eg. email). This is used by the getIdentity method. And is called using a POST request.\n- identityProperty : Property returned by the identityURL, for the unique login ID, defaults to \"email\"\n\nPublic methods:\n- getAuthorizationSessionUrl() : Returns the authorization session URL (String), this should be used to redirect the user.\n- getValidAccessToken(code) : Returns a valid access token (String), requires the response code given to user when they are redirected back to redirectURL\n- getIdentity(token) : Returns the identity of the user (String)\n\nImplementation notes:\n\nAny exceptions thrown by the class will be of type RuntimeException.\n\nImport and use the 'picoded.core.web.RequestHttp' and 'picoded.core.web.ResponseHttp', for performing HTTP API request\nThe following is an example of how to use the RequestHttp API\n\n```\n// Perform a GET request\nHttpResponse response = RequestHttp.get( requestURL );\n\n// Alternatively a POST request as a JSON request, with parameters\nMap<String,Object> requestParams = new HashMap<String,Object>();\nrequestParams.put(\"test\",\"one\");\nresponse = RequestHttp.postJSON( requestURL, requestParams );\n\n// Get the result string\nString getResultString = response.toString();\n\n// Or the response code\nint statusCode = response.statusCode();\n\n// Or a string object map\nMap<String,Object> resultMap = response.toMap();\n```\n\n---\n\n## Method Specific Specification\n\n### constructor\n\nThe constructor accepts the following parameters, which would be provided in a java Map:\n- authorizationURL (String)\n- tokenURL (String)\n- redirectURL (String)\n- clientID (String)\n- clientSecret (String)\n- identityURL (String)\n- identityProperty (String, optional)\n\n### getAuthorizationSessionUrl\n\nThe getAuthorizationSessionUrl method returns a String containing the authorization session URL.\n\nImplementation note: Do ensure to URI encode the redirectURL, when generating the session URL\n\nYou will need to handle both situations where the 'authorizationURL'\n- contains a GET parameters (eg. http://example.com/oauth2/auth?param=something)\n- contains no GET parameters (eg. http://example.com/oauth2/auth)\n\nIf the 'authorizationURL' is not a valid URL format, throw an error accordingly.\n\n### getValidAccessToken\n\nThe getValidAccessToken method returns a valid access token as a String.\n\n### getIdentity\n\nThe getIdentity method returns the identity of the user as a String.\nFor 'getIdentity', perform the request using the token with basic authentication. Headers can be set for RequestHttp, similar to the following example.\n\n```\n// Alternatively a POST request as a JSON request, with parameters\nMap<String,Object> reqParams = new HashMap<String,Object>();\nreqParams.put(\"test\",\"one\");\n\n// Custom cookies\nMap<String,Object> reqCookie = new HashMap<String,Object>();\nreqCookie.put(\"cookie_a\",\"b\");\n\n// Custom headers\nMap<String,Object> reqHeaders = new HashMap<String,Object>();\nreqHeaders.put(\"custom_header\",\"c\");\n\n// Request with cookie and header\n// note that any argument can be null, if the parameter is not needed\nHttpResponse response = RequestHttp.postJSON( requestURL, reqParams, reqCookie, reqHeaders );\n```\n<<{{~~}}>>\n\ndeveloper:\nPlease suggest changes, to improve the specification. In point form.\nReply with NO_SUGGESTION if there is no suggested changes, to improve the specification.\n\nAI:\n","completion":"NO_SUGGESTION"}
